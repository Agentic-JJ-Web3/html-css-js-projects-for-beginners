<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Display Widget</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            transition: all 0.5s ease;
            overflow-x: hidden;
        }

        /* Dynamic backgrounds */
        .sunny { background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%); }
        .cloudy { background: linear-gradient(135deg, #636e72 0%, #2d3436 100%); }
        .rainy { background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%); }
        .night { background: linear-gradient(135deg, #2d3436 0%, #000000 100%); }
        .default { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }

        /* Weather animations */
        .weather-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .rain-drop {
            position: absolute;
            width: 2px;
            height: 20px;
            background: rgba(255, 255, 255, 0.6);
            animation: fall 1s linear infinite;
        }

        @keyframes fall {
            0% { transform: translateY(-100vh); opacity: 1; }
            100% { transform: translateY(100vh); opacity: 0; }
        }

        .cloud {
            position: absolute;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50px;
            animation: float 20s linear infinite;
        }

        @keyframes float {
            0% { transform: translateX(-100px); }
            100% { transform: translateX(calc(100vw + 100px)); }
        }

        /* Main container */
        .container {
            position: relative;
            z-index: 2;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .logo {
            font-size: 2rem;
            font-weight: bold;
            color: white;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .controls {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        /* Theme toggle */
        .theme-toggle {
            position: relative;
            width: 60px;
            height: 30px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .theme-toggle::before {
            content: '‚òÄÔ∏è';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .dark-mode .theme-toggle::before {
            content: 'üåô';
            transform: translateX(30px);
            background: #2d3436;
        }

        /* Search bar */
        .search-container {
            position: relative;
        }

        .search-input {
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            color: white;
            placeholder-color: rgba(255, 255, 255, 0.7);
            width: 250px;
            transition: all 0.3s ease;
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .search-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        /* Buttons */
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .refresh-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .refresh-btn.spinning {
            animation: spin 1s linear;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Main weather card */
        .weather-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 40px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .weather-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.2);
        }

        .current-weather {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 30px;
            align-items: center;
        }

        .weather-info h2 {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .weather-info p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        .temperature {
            font-size: 4rem !important;
            font-weight: bold;
            margin: 20px 0;
        }

        .weather-icon {
            font-size: 6rem;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        /* Weather details grid */
        .weather-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .detail-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .detail-card:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .detail-card h4 {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .detail-card p {
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
        }

        /* Forecast section */
        .forecast-section {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .forecast-section h3 {
            color: white;
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .forecast-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .forecast-card:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
        }

        .forecast-card h4 {
            color: white;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .forecast-card .forecast-icon {
            font-size: 2rem;
            margin: 10px 0;
        }

        .forecast-card .forecast-temp {
            color: white;
            font-weight: bold;
        }

        /* Open source section */
        .open-source-section {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
        }

        .open-source-badge {
            display: inline-block;
            background: linear-gradient(45deg, #00b894, #00cec9);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            margin-bottom: 20px;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .open-source-badge:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(0, 184, 148, 0.3);
        }

        .github-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .github-btn {
            background: #333;
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            text-decoration: none;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .github-btn:hover {
            background: #555;
            transform: translateY(-2px);
        }

        .project-description {
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.6;
            margin-top: 20px;
        }

        /* Loading and error states */
        .loading {
            text-align: center;
            color: white;
            font-size: 1.2rem;
            padding: 40px;
        }

        .error {
            background: rgba(231, 76, 60, 0.2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
            border: 1px solid rgba(231, 76, 60, 0.3);
        }

        /* Dark mode styles */
        .dark-mode {
            color: #ecf0f1;
        }

        .dark-mode .weather-card,
        .dark-mode .forecast-section,
        .dark-mode .open-source-section {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .dark-mode .detail-card,
        .dark-mode .forecast-card {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Unit toggle */
        .unit-toggle {
            display: flex;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 5px;
            backdrop-filter: blur(10px);
        }

        .unit-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            color: rgba(255, 255, 255, 0.7);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .unit-btn.active {
            background: rgba(255, 255, 255, 0.3);
            color: white;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header {
                flex-direction: column;
                text-align: center;
            }
            
            .current-weather {
                grid-template-columns: 1fr;
                text-align: center;
            }
            
            .weather-info h2 {
                font-size: 2rem;
            }
            
            .temperature {
                font-size: 3rem !important;
            }
            
            .weather-icon {
                font-size: 4rem;
            }
            
            .search-input {
                width: 100%;
            }
            
            .github-buttons {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body class="default">
    <div class="weather-animation" id="weatherAnimation"></div>
    
    <div class="container">
        <header class="header">
            <div class="logo">üå§Ô∏è Weather Widget</div>
            <div class="controls">
                <div class="unit-toggle">
                    <button class="unit-btn active" data-unit="celsius">¬∞C</button>
                    <button class="unit-btn" data-unit="fahrenheit">¬∞F</button>
                </div>
                <div class="search-container">
                    <input type="text" class="search-input" placeholder="Search city..." id="citySearch">
                </div>
                <button class="btn" onclick="getCurrentLocation()">üìç My Location</button>
                <button class="btn refresh-btn" onclick="refreshWeather()" id="refreshBtn">üîÑ</button>
                <div class="theme-toggle" onclick="toggleTheme()"></div>
            </div>
        </header>

        <main>
            <div class="weather-card" id="weatherCard">
                <div class="loading" id="loading">
                    <p>üåç Getting your location and weather data...</p>
                </div>
            </div>

            <div class="forecast-section" id="forecastSection" style="display: none;">
                <h3>3-Day Forecast</h3>
                <div class="forecast-grid" id="forecastGrid"></div>
            </div>

            <div class="open-source-section">
                <a href="https://github.com/Agentic-JJ-Web3/html-css-js-projects-for-beginners" class="open-source-badge" target="_blank">
                    üöÄ Open Source Project
                </a>
                <div class="github-buttons">
                    <a href="https://github.com/Agentic-JJ-Web3/html-css-js-projects-for-beginners" class="github-btn" target="_blank">
                        ‚≠ê Star on GitHub
                    </a>
                    <a href="https://github.com/Agentic-JJ-Web3/html-css-js-projects-for-beginners/fork" class="github-btn" target="_blank">
                        üç¥ Fork & Contribute
                    </a>
                </div>
                <div class="project-description">
                    <p><strong>Learn by Building!</strong> This weather widget is part of a comprehensive collection of HTML, CSS, and JavaScript projects designed for beginners. Perfect for learning modern web development, API integration, and responsive design. Join our community of developers and contribute to open-source projects!</p>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Global variables
        let currentUnit = 'celsius';
        let currentWeatherData = null;
        const API_KEY = 'ad3ad70e69684cf389f234922251502'; // Your WeatherAPI.com key
        const BASE_URL = 'https://api.weatherapi.com/v1';

        // WeatherAPI.com endpoints
        const ENDPOINTS = {
            current: `${BASE_URL}/current.json`,
            forecast: `${BASE_URL}/forecast.json`,
            search: `${BASE_URL}/search.json`
        };

        // Weather icons mapping for WeatherAPI conditions
        const weatherIcons = {
            1000: '‚òÄÔ∏è', // Sunny
            1003: 'üå§Ô∏è', // Partly cloudy
            1006: '‚òÅÔ∏è', // Cloudy
            1009: '‚òÅÔ∏è', // Overcast
            1030: 'üå´Ô∏è', // Mist
            1063: 'üå¶Ô∏è', // Patchy rain possible
            1066: 'üå®Ô∏è', // Patchy snow possible
            1069: 'üå®Ô∏è', // Patchy sleet possible
            1072: 'üå®Ô∏è', // Patchy freezing drizzle possible
            1087: '‚õàÔ∏è', // Thundery outbreaks possible
            1114: '‚ùÑÔ∏è', // Blowing snow
            1117: '‚ùÑÔ∏è', // Blizzard
            1135: 'üå´Ô∏è', // Fog
            1147: 'üå´Ô∏è', // Freezing fog
            1150: 'üå¶Ô∏è', // Patchy light drizzle
            1153: 'üå¶Ô∏è', // Light drizzle
            1168: 'üå®Ô∏è', // Freezing drizzle
            1171: 'üå®Ô∏è', // Heavy freezing drizzle
            1180: 'üå¶Ô∏è', // Patchy light rain
            1183: 'üåßÔ∏è', // Light rain
            1186: 'üå¶Ô∏è', // Moderate rain at times
            1189: 'üåßÔ∏è', // Moderate rain
            1192: 'üåßÔ∏è', // Heavy rain at times
            1195: 'üåßÔ∏è', // Heavy rain
            1198: 'üå®Ô∏è', // Light freezing rain
            1201: 'üå®Ô∏è', // Moderate or heavy freezing rain
            1204: 'üå®Ô∏è', // Light sleet
            1207: 'üå®Ô∏è', // Moderate or heavy sleet
            1210: 'üå®Ô∏è', // Patchy light snow
            1213: '‚ùÑÔ∏è', // Light snow
            1216: 'üå®Ô∏è', // Patchy moderate snow
            1219: '‚ùÑÔ∏è', // Moderate snow
            1222: 'üå®Ô∏è', // Patchy heavy snow
            1225: '‚ùÑÔ∏è', // Heavy snow
            1237: 'üå®Ô∏è', // Ice pellets
            1240: 'üå¶Ô∏è', // Light rain shower
            1243: 'üåßÔ∏è', // Moderate or heavy rain shower
            1246: 'üåßÔ∏è', // Torrential rain shower
            1249: 'üå®Ô∏è', // Light sleet showers
            1252: 'üå®Ô∏è', // Moderate or heavy sleet showers
            1255: 'üå®Ô∏è', // Light snow showers
            1258: '‚ùÑÔ∏è', // Moderate or heavy snow showers
            1261: 'üå®Ô∏è', // Light showers of ice pellets
            1264: 'üå®Ô∏è', // Moderate or heavy showers of ice pellets
            1273: '‚õàÔ∏è', // Patchy light rain with thunder
            1276: '‚õàÔ∏è', // Moderate or heavy rain with thunder
            1279: '‚õàÔ∏è', // Patchy light snow with thunder
            1282: '‚õàÔ∏è'  // Moderate or heavy snow with thunder
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
        });

        function initializeApp() {
            // Check for saved theme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
            }

            // Check for saved unit
            const savedUnit = localStorage.getItem('unit');
            if (savedUnit) {
                currentUnit = savedUnit;
                updateUnitButtons();
            }

            // Get initial weather
            getCurrentLocation();
        }

        function setupEventListeners() {
            // City search
            const searchInput = document.getElementById('citySearch');
            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchWeather(this.value);
                }
            });

            // Unit toggle
            document.querySelectorAll('.unit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    currentUnit = this.dataset.unit;
                    localStorage.setItem('unit', currentUnit);
                    updateUnitButtons();
                    if (currentWeatherData) {
                        displayWeatherData(currentWeatherData);
                    }
                });
            });
        }

        function updateUnitButtons() {
            document.querySelectorAll('.unit-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.unit === currentUnit);
            });
        }

        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        }

        function getCurrentLocation() {
            if (navigator.geolocation) {
                showLoading();
                navigator.geolocation.getCurrentPosition(
                    position => {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;
                        fetchWeatherByCoords(lat, lon);
                    },
                    error => {
                        console.error('Geolocation error:', error);
                        // Fallback to a default city
                        searchWeather('London');
                    }
                );
            } else {
                searchWeather('London');
            }
        }

        async function searchWeather(city) {
            if (!city.trim()) return;
            
            showLoading();
            
            try {
                const response = await fetch(`${ENDPOINTS.forecast}?key=${API_KEY}&q=${encodeURIComponent(city)}&days=3&aqi=yes&alerts=yes`);
                
                if (!response.ok) {
                    throw new Error(`Weather data not found for "${city}"`);
                }
                
                const data = await response.json();
                processWeatherData(data);
                
            } catch (error) {
                console.error('Weather API error:', error);
                showError(`Unable to fetch weather data for "${city}". Please check the city name and try again.`);
            }
        }

        async function fetchWeatherByCoords(lat, lon) {
            try {
                const response = await fetch(`${ENDPOINTS.forecast}?key=${API_KEY}&q=${lat},${lon}&days=3&aqi=yes&alerts=yes`);
                
                if (!response.ok) {
                    throw new Error('Weather data not available for your location');
                }
                
                const data = await response.json();
                processWeatherData(data);
                
            } catch (error) {
                console.error('Weather API error:', error);
                showError('Unable to fetch weather data for your location. Please try searching for a city instead.');
            }
        }

        function processWeatherData(data) {
            // Transform WeatherAPI data to our format
            const current = data.current;
            const location = data.location;
            const forecast = data.forecast.forecastday;
            
            const processedData = {
                location: `${location.name}, ${location.country}`,
                temperature: current.temp_c,
                condition: current.condition.text.toLowerCase(),
                conditionCode: current.condition.code,
                description: current.condition.text,
                humidity: current.humidity,
                windSpeed: Math.round(current.wind_kph),
                uvIndex: current.uv,
                airQuality: getAirQualityText(data.current.air_quality?.['us-epa-index'] || 1),
                pressure: current.pressure_mb,
                visibility: current.vis_km,
                feelsLike: current.feelslike_c,
                forecast: forecast.map((day, index) => {
                    const date = new Date(day.date);
                    const dayName = index === 0 ? 'Today' : 
                                   index === 1 ? 'Tomorrow' : 
                                   date.toLocaleDateString('en', { weekday: 'short' });
                    
                    return {
                        day: dayName,
                        icon: weatherIcons[day.day.condition.code] || 'üå§Ô∏è',
                        high: Math.round(day.day.maxtemp_c),
                        low: Math.round(day.day.mintemp_c),
                        condition: day.day.condition.text,
                        conditionCode: day.day.condition.code
                    };
                })
            };

            currentWeatherData = processedData;
            displayWeatherData(processedData);
            updateBackground(processedData.conditionCode);
            createWeatherAnimation(processedData.conditionCode);
        }

        function getAirQualityText(index) {
            const qualities = {
                1: 'Good',
                2: 'Moderate', 
                3: 'Unhealthy for Sensitive',
                4: 'Unhealthy',
                5: 'Very Unhealthy',
                6: 'Hazardous'
            };
            return qualities[index] || 'Unknown';
        }

        function displayWeatherData(data) {
            const weatherCard = document.getElementById('weatherCard');
            const temp = currentUnit === 'celsius' ? data.temperature : (data.temperature * 9/5) + 32;
            const feelsLike = currentUnit === 'celsius' ? data.feelsLike : (data.feelsLike * 9/5) + 32;
            const unit = currentUnit === 'celsius' ? '¬∞C' : '¬∞F';
            
            weatherCard.innerHTML = `
                <div class="current-weather">
                    <div class="weather-info">
                        <h2>${data.location}</h2>
                        <p>${data.description}</p>
                        <div class="temperature">${Math.round(temp)}${unit}</div>
                        <p>Feels like ${Math.round(feelsLike)}${unit}</p>
                    </div>
                    <div class="weather-icon">${weatherIcons[data.conditionCode] || weatherIcons[1000]}</div>
                </div>
                <div class="weather-details">
                    <div class="detail-card">
                        <h4>Humidity</h4>
                        <p>${data.humidity}%</p>
                    </div>
                    <div class="detail-card">
                        <h4>Wind Speed</h4>
                        <p>${data.windSpeed} km/h</p>
                    </div>
                    <div class="detail-card">
                        <h4>UV Index</h4>
                        <p>${data.uvIndex}</p>
                    </div>
                    <div class="detail-card">
                        <h4>Air Quality</h4>
                        <p>${data.airQuality}</p>
                    </div>
                    <div class="detail-card">
                        <h4>Pressure</h4>
                        <p>${data.pressure} mb</p>
                    </div>
                    <div class="detail-card">
                        <h4>Visibility</h4>
                        <p>${data.visibility} km</p>
                    </div>
                </div>
            `;

            displayForecast(data.forecast);
            document.getElementById('forecastSection').style.display = 'block';
        }

        function displayForecast(forecast) {
            const forecastGrid = document.getElementById('forecastGrid');
            forecastGrid.innerHTML = forecast.map(day => {
                const high = currentUnit === 'celsius' ? day.high : (day.high * 9/5) + 32;
                const low = currentUnit === 'celsius' ? day.low : (day.low * 9/5) + 32;
                const unit = currentUnit === 'celsius' ? '¬∞C' : '¬∞F';
                
                return `
                    <div class="forecast-card">
                        <h4>${day.day}</h4>
                        <div class="forecast-icon">${day.icon}</div>
                        <div class="forecast-temp">${Math.round(high)}¬∞ / ${Math.round(low)}¬∞${unit}</div>
                        <p style="color: rgba(255,255,255,0.8); font-size: 0.9rem; margin-top: 5px;">${day.condition}</p>
                    </div>
                `;
            }).join('');
        }

        function updateBackground(conditionCode) {
            const body = document.body;
            const hour = new Date().getHours();
            
            // Remove existing weather classes
            body.classList.remove('sunny', 'cloudy', 'rainy', 'night', 'default');
            
            if (hour < 6 || hour > 20) {
                body.classList.add('night');
            } else if ([1063, 1150, 1153, 1180, 1183, 1186, 1189, 1192, 1195, 1240, 1243, 1246, 1273, 1276].includes(conditionCode)) {
                body.classList.add('rainy');
            } else if ([1003, 1006, 1009, 1030, 1135, 1147].includes(conditionCode)) {
                body.classList.add('cloudy');
            } else if (conditionCode === 1000) {
                body.classList.add('sunny');
            } else {
                body.classList.add('default');
            }
        }

        function createWeatherAnimation(conditionCode) {
            const animationContainer = document.getElementById('weatherAnimation');
            animationContainer.innerHTML = '';

            // Rain animation for rainy conditions
            if ([1063, 1150, 1153, 1180, 1183, 1186, 1189, 1192, 1195, 1240, 1243, 1246, 1273, 1276].includes(conditionCode)) {
                createRainAnimation();
            } 
            // Cloud animation for cloudy conditions
            else if ([1003, 1006, 1009, 1030, 1135, 1147].includes(conditionCode)) {
                createCloudAnimation();
            }
        }

        function createRainAnimation() {
            const animationContainer = document.getElementById('weatherAnimation');
            
            for (let i = 0; i < 50; i++) {
                const drop = document.createElement('div');
                drop.className = 'rain-drop';
                drop.style.left = Math.random() * 100 + '%';
                drop.style.animationDelay = Math.random() * 2 + 's';
                drop.style.animationDuration = (Math.random() * 0.5 + 0.5) + 's';
                animationContainer.appendChild(drop);
            }
        }

        function createCloudAnimation() {
            const animationContainer = document.getElementById('weatherAnimation');
            
            for (let i = 0; i < 3; i++) {
                const cloud = document.createElement('div');
                cloud.className = 'cloud';
                cloud.style.top = Math.random() * 30 + '%';
                cloud.style.width = (Math.random() * 100 + 80) + 'px';
                cloud.style.height = (Math.random() * 40 + 40) + 'px';
                cloud.style.animationDelay = Math.random() * 20 + 's';
                cloud.style.animationDuration = (Math.random() * 10 + 15) + 's';
                animationContainer.appendChild(cloud);
            }
        }

        function refreshWeather() {
            const refreshBtn = document.getElementById('refreshBtn');
            refreshBtn.classList.add('spinning');
            
            const searchInput = document.getElementById('citySearch');
            if (searchInput.value.trim()) {
                searchWeather(searchInput.value);
            } else {
                getCurrentLocation();
            }
            
            setTimeout(() => {
                refreshBtn.classList.remove('spinning');
            }, 1000);
        }

        function showLoading() {
            const weatherCard = document.getElementById('weatherCard');
            weatherCard.innerHTML = `
                <div class="loading">
                    <p>üåç Fetching real-time weather data...</p>
                </div>
            `;
            document.getElementById('forecastSection').style.display = 'none';
        }

        function showError(message) {
            const weatherCard = document.getElementById('weatherCard');
            weatherCard.innerHTML = `
                <div class="error">
                    <h3>‚ö†Ô∏è Weather Data Unavailable</h3>
                    <p>${message}</p>
                    <button class="btn" onclick="getCurrentLocation()" style="margin-top: 15px;">Try My Location</button>
                </div>
            `;
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'975fc848e01d7685',t:'MTc1NjM0MTg4OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
